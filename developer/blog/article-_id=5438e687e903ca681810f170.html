<!DOCTYPE html><html lang="zh"><head><title>前端模块化杂谈 - Teambition</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="keywords" content="团队协作工具,团队管理工具,项目管理工具,项目协作工具,任务分配,任务进度,文件存储,文件共享,在线预览,知识管理,日程管理,项目管理,项目讨论,项目沟通"><meta name="description" content="Teambition 是一个简单，高效的项目协作工具，你可以在这里管理项目，跟踪任务进度，存储项目文件，让你的团队协作更高效。"><meta property="og:description" content="Teambition 是一家追求卓越技术的公司，我们工程师都很 geek，我们使用了很多新潮的，开源的技术。同时我们也贡献了很多开源的项目。我们希望能够把一些技术经验分享给大家。于是有了这个「创作随笔」。废话休说，「创作随笔」第一弹，来自我们的前端工程师寸志，谈一谈他在前端模块化开发方面的一些感想。"><meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta name="apple-itunes-app" content="app-id=656664814"/><link rel="alternate" href="../../../site/404.html" hreflang="x-default" /><link rel="shortcut icon" href="../../../favicon.ico"><link rel="stylesheet" href="https://dn-st.teambition.net/site/v2.0.0/css/lib.fc2b25bd.css"><link rel="stylesheet" href="https://dn-st.teambition.net/site/v2.0.0/css/app.f8bcf230.css"></head><body class="page-developer-article tbsite-article zh"><header class="site-header "><div class="container"><nav class="navbar" role="navigation"><div class="navbar-header"><button class="btn btn-primary navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">菜单</button><a class="navbar-brand" href="../../index.html" data-gta="event" data-category="out-top-nav" data-action="tb logo">Teambition・最好用的团队协作工具</a></div><div class="collapse navbar-collapse"><div class="items-wrap"><ul class="navbar-button list-inline"><li class="switch-locale-wrap"><div class="dropdown switch-locale"><a class="dropdown-toggle zh">中文版</a><ul class="dropdown-menu" role="menu" aria-labelledby="dLabel"><li><a href="../../../tw/developer/blog/article-_id=5438e687e903ca681810f170.html" class="tw">繁體版</a></li><li><a href="../../../en/developer/blog/article-_id=5438e687e903ca681810f170.html" class="en">English</a></li><li><a href="../../../ko/developer/blog/article-_id=5438e687e903ca681810f170.html" class="ko">한국어</a></li></ul></div></li><li><a class="btn btn-default btn-sm login" href="https://account.teambition.com/login" data-gta="event" data-category="out-top-nav" data-action="login">登录</a></li><li><a class="btn btn-default btn-sm signup" href="https://account.teambition.com/signup?from=nav" data-gta="event" data-category="out-top-nav" data-action="signup">免费注册</a></li></ul><ul class="nav navbar-nav"><li ><a href="../../tour.html" data-gta="event" data-category="out-top-nav" data-action="tour">功能</a></li><li ><a href="../../pricing.html" data-gta="event" data-category="out-top-nav" data-action="prices">价格</a></li><li ><a href="../../apps.html" data-gta="event" data-category="out-top-nav" data-action="apps">下载</a></li><li><a href="https://bbs.teambition.com" data-gta="event" data-category="out-top-nav" data-action="community">社区</a></li><li><a href="https://blog.teambition.com/zh" data-gta="event" data-category="out-top-nav" data-action="blog">博客</a></li></ul></div></div></nav></div></header><div class="site-main"><div class="article-content"><div class="topbanner not-image"  style="background-color: #494949;"><div class="bg-mask"><div class="container max1010"><div class="return"><a href="../blog.html"><span class="icon icon-chevron-left"></span>返回 创作随笔</a></div><h1 class="title">前端模块化杂谈</h1></div></div></div><div class="main-content readable"><div class="container max730"><blockquote>
<p><a href="http://teambition.com">Teambition</a>是一家追求卓越技术的公司，我们工程师都很Geek，我们使用了很多新潮的，开源的技术。同时我们也贡献了很多<a href="http://github.com/teambition">开源的项目</a>。我们希望能够把一些技术经验分享给大家。于是有了这个「创作随笔」。废话休说，「创作随笔」第一弹，来自我们的前端工程师<a href="http://weibo.com/chromeappsstore">寸志</a>，谈一谈他在前端模块化开发方面的一些感想。</p>
</blockquote>
<p>在模块化方面，Node.js 就显得游刃有余。</p>
<p>作为用户，我们把代码放到一个个 JavaScript 文件中，然后 Node.js 就有一套规则帮我们把这些代码组织起来，Node.js 还有包的概念，于是我们就可以使用 npm 将代码放到一个个包中，放到这里那里的 node_modules 中使用。很方便不是？感谢Node.js。</p>
<p>可在浏览器端，模块化这事就没那么简单了。</p>
<h2 id="-">前端的模块</h2>
<p>前端的一个模块包含很多东西，JavaScript、CSS、图片字体等等。甚至，可能根据业务需要，还包含国际化的文件。一个模块如果包含以上这些东西，复杂度就上了几个数量级。</p>
<p>怎么复杂了？和高大上的 iOS 开发比起来，人家有 SDK，代码随便往项目里扔，图片扔，国际化有成熟的解决方案，最后构建一下一个可运行的应用就出来了。</p>
<p>前端缺乏 SDK，没有成熟统一的开发方案，集成方案，前端模块化之路很崎岖。开发时，我们需要一种方式来组织，加载代码，发布时，我们还需要另外一种方式将代码、资源合并到一起发布。</p>
<h2 id="-">眼前的现状</h2>
<p>TJ 给出了自己解决方案——Component。可以份文件开发，然后再把 JavaScript、CSS 和模板文件合并到一起。我只能说，理想很丰满，现实很骨感，Component 无法适应各种奇葩的应用场景。</p>
<p>或者我们自由一点——</p>
<p>依赖的第三方模块，我们有 Bower，好爽，运行个命令，依赖就安装好了。</p>
<p>但是 Bower 不是银弹，Bower 只解决了模块依赖，安装依赖的问题。Bower中的模块没有任何标准和规则，有的只有 JavaScript，有的支持 AMD，有的可能只有 CSS。文件结构，入口文件完全不一样。并不是使用 Bower 安装的模块我们就可以使用同样的方式使用任何一个模块，使用某种工具将这些模块打包发布！</p>
<p>AMD 作为事实上的前端 JavaScript 模块化标准，或可以出来解救我们。很多 Bower 模块都是支持 AMD 规范的。而且 AMD 还提供了打包工具，总算有点解脱了。好景不长……</p>
<p>每个模块中的 HTML 怎么办，如果我们使用的框架是 Backbone，注定我们要将 HTML 模板转换成 JavaScript 模块，或者使用模块加载器的插件来实现。如果我们使用 AngularJS，那倒是可以交由 AngularJS。发布时 Backbone 中的模块使用 AMD 打包，AngularJS 可以使用 Grunt 内联到页面中。</p>
<p>HTML 模块也没有固定的模式，没有固定的 SDK 来解脱我们。我们只能组合现有的工具！</p>
<p>CSS 就更不用说了，分开写，使用 LESS、SASS 来组织？再一次没有固定的模式没有 SDK。</p>
<p>还有图片呢，字体呢？</p>
<h2 id="-">拼凑的方案</h2>
<p>前端如果想做模块化开发，首先需要针对每一种资源（JavaScript、CSS、模板等）寻找一种模块与集成方案，然后需要根据情况的不同选用不同的工具框架拼凑出来。</p>
<h3 id="javascript">JavaScript</h3>
<p>目前比较拿的出手的，也就是 JavaScript 的模块化，比如 AMD 或者 CMD 等等，分别可以使用 RequireJS 和 SeaJS。</p>
<blockquote>
<p>去年在研究基于 Backbone 的框架 Marionette 时，想与 Sea.js 结合使用。现在来看这种组合是完全没有必要的。Marionette 提供了模块化的组织方案，反而生拉硬扯在一起，冲突得很难受。其实把 JavaScript 文件一列放在 HTML 中也没什么问题。</p>
</blockquote>
<p>究竟使用什么来实现 JavaScript，往往与选择的 JavaScript 框架有关，选 Backbone可以 AMD，也可以 CMD。选 AngularJS 直接引用就行。</p>
<h3 id="css">CSS</h3>
<p>CSS 模块化应该是两方面的问题——</p>
<p>一是模块必须有一套基础样式。与 JavaScript 相比，CSS 冲突简直是家常便饭，Shadow DOM 还没成熟，原生的 CSS 样式隔离还在路上。所以必须有一套基础样式来规定这一套模块化组件的样式。我们可以选 Bootstrap，如果闲它太重，也可以自己写。</p>
<p>其次，每个组件必须有命名空间，避免组件间样式冲突。如果选择使用 LESS、SASS 等，那就比较好办，它们的缩进语法避免写很多重复的 CSS 代码。</p>
<h3 id="html-">HTML 模板</h3>
<p>如果使用 AngularJS，那 AngularJS 已经帮您解决了模板模块化的问题，AngularJS可以根据模块代码中的引用加载对应的 HTML。如果使用 Backbone，可以选择各种各样的模板引擎，Mustache？不过比起 AngularJS 就低端些，我们必须自己处理模板文件，要么通过模块加载器通过 XHR 请求，然后动态编译；或者将 Mustache 编译成 JS，在当做模块加载。</p>
<h3 id="-">图片、字体？</h3>
<p>放在使用他们的模块中，该怎么引用就怎么引用。</p>
<p>国际化文件？这些就不多说了，总之，每种文件需要选定一种开发的组织方式。</p>
<h2 id="-">模块分发</h2>
<p>模块采用统一的模式来开发之后，只需选定一种包的分发方式就行了——Bower。npm 不适合这样的场景，npm 的版本管理太过细致了。如果同一个项目中允许出现同一模块的不同版本，事情就做的太过复杂了。</p>
<h2 id="-">发布上线</h2>
<p>发布上线必须一个以终为始的过程。如果你不追求网站或者应用的速度，那就把那些开发文件直接丢到生产服务器上去吧。别说，我还真见过这样的商用的网站。</p>
<p>如果讲究一些方案，资源合并成数个文件，代码线上组合和运行方式完全可以与本地开发不一样。只需要功能在就行。</p>
<p>JavaScript 代码打成一个文件，或者两个？都行。如果使用 RequireJS，那 RequireJS 提供了打包的工具，打包成几个文件，什么粒度，都行。如果是 Sea.js 也有对应的工具。就算文件都是一个一个列出来，我们也总是可以打出来你想要的文件。</p>
<p>CSS 等等其他资源都是如此，就算开发时各自不同的结构模式，打包时都是可以打的。</p>
<p>至于上线 CDN，版本号缓存什么的并不在本文的讨论范围之内。</p>
<h2 id="-">总结</h2>
<p>前端模块没有什么特效药。唯一要遵守的原则就是，<strong>比起 Node.js 来讲，每种资源必须要有一种自己的开发和上线组织方式</strong>（Node.js 开发和上线都是一致的），开发和上线完全可以是两种方式，大可不必人云亦云，只要适合可以随意组合；CSS 在 CSS Scoped Style 正式使用之前，应该有一套基础样式和沙盒（模块样式命名空间）。</p>
</div></div><div class="article-toolbar text-center"><div class="share-button-group"><a href="http://service.weibo.com/share/share.php?ralateUid=2673498793&amp;url=https://www.teambition.com/developer/blog/article%3F_id=5438e687e903ca681810f170%26p=weibo-share&amp;title=%E3%80%90%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E6%9D%82%E8%B0%88%E3%80%91Teambition%20%E6%98%AF%E4%B8%80%E5%AE%B6%E8%BF%BD%E6%B1%82%E5%8D%93%E8%B6%8A%E6%8A%80%E6%9C%AF%E7%9A%84%E5%85%AC%E5%8F%B8%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B7%A5%E7%A8%8B%E5%B8%88%E9%83%BD%E5%BE%88%20geek%EF%BC%8C%E6%88%91%E4%BB%AC%E4%BD%BF%E7%94%A8%E4%BA%86%E5%BE%88%E5%A4%9A%E6%96%B0%E6%BD%AE%E7%9A%84%EF%BC%8C%E5%BC%80%E6%BA%90%E7%9A%84%E6%8A%80%E6%9C%AF%E3%80%82%E5%90%8C%E6%97%B6%E6%88%91%E4%BB%AC%E4%B9%9F%E8%B4%A1%E7%8C%AE%E4%BA%86%E5%BE%88%E5%A4%9A%E5%BC%80%E6%BA%90%E7%9A%84%E9%A1%B9%E7%9B%AE%E3%80%82%E6%88%91%E4%BB%AC%E5%B8%8C%E6%9C%9B%E8%83%BD%E5%A4%9F%E6%8A%8A%E4%B8%80%E4%BA%9B%E6%8A%80%E6%9C%AF%E7%BB%8F%E9%AA%8C%E5%88%86%E4%BA%AB%E7%BB%99%E5%A4%A7%E5%AE%B6%E3%80%82%E4%BA%8E%E6%98%AF%E6%9C%89%E4%BA%86%E8%BF%99%E4%B8%AA%E3%80%8C%E5%88%9B%E4%BD%9C%E9%9A%8F%E7%AC%94%E3%80%8D%E3%80%82%E5%BA%9F%E8%AF%9D%E4%BC%91%E8%AF%B4%EF%BC%8C%E3%80%8C%E5%88%9B%E4%BD%9C%E9%9A%8F%E7%AC%94%E3%80%8D%E7%AC%AC%E4%B8%80%E5%BC%B9%EF%BC%8C%E6%9D%A5%E8%87%AA%E6%88%91%E4%BB%AC%E7%9A%84%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%88%E5%AF%B8%E5%BF%97%EF%BC%8C%E8%B0%88%E4%B8%80%E8%B0%88%E4%BB%96%E5%9C%A8%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E5%BC%80%E5%8F%91%E6%96%B9%E9%9D%A2%E7%9A%84%E4%B8%80%E4%BA%9B%E6%84%9F%E6%83%B3%E3%80%82&amp;pic=" target="_blank" title="分享到微博" class="btn weibo"><span class="icon icon-weibo"></span></a><a data-toggle="modal" data-target="#modalWechat" title="分享到微信朋友圈" class="btn wechat"><span class="icon icon-wechat"></span></a><a href="https://twitter.com/intent/tweet?text=%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E6%9D%82%E8%B0%88%20https://www.teambition.com/developer/blog/article%3F_id=5438e687e903ca681810f170%26p=twitter-share" target="_blank" title="分享到 Twitter" class="btn twitter"><span class="icon icon-twitter"></span></a><a href="http://www.facebook.com/sharer.php?u=https://www.teambition.com/developer/blog/article%3F_id=5438e687e903ca681810f170%26p=facebook-share&amp;t=%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E6%9D%82%E8%B0%88" target="_blank" title="分享到 Facebook" class="btn facebook"><span class="icon icon-facebook"></span></a></div></div><div class="tbsite-post-info"><div class="container max730"><div class="infobar clearfix"><span class="author"><span class="avatar img-circle" style="background-image:url('https://file2.teambition.com/site_media/cache/98/8e/3cda1d3e84a40273311ebbe3b96a8e98_250x250.png')" ></span><span class="username">齐俊元</span></span><span class="time">2014-05-23</span></div></div></div><div class="switch-nav"><div class="container max730"><div class="clearfix"><a href="../blog.html" class="gray prev"><span class="icon icon-chevron-left"></span>返回 创作随笔</a></div></div></div></div><div class="modal fade modal-wechat" id="modalWechat" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span>&times;</span></button><h4 class="modal-title" id="myModalLabel">分享到微信朋友圈</h4></div><div class="modal-body"><div class="qrcode" data-src="https://www.teambition.com/developer/blog/article?_id=5438e687e903ca681810f170&p=wechat-share" data-desc="Teambition 是一家追求卓越技术的公司，我们工程师都很 geek，我们使用了很多新潮的，开源的技术。同时我们也贡献了很多开源的项目。我们希望能够把一些技术经验分享给大家。于是有了这个「创作随笔」。废话休说，「创作随笔」第一弹，来自我们的前端工程师寸志，谈一谈他在前端模块化开发方面的一些感想。"></div></div></div></div></div></div><footer class="site-footer hack-webkit-render"><div class="container max1010"><div class="row footer-nav"><div class="col-md-12 clearfix"><ul class="nav-group"><h4>产品</h4><li><a href="../../tour.html" data-gta="event" data-category="out-footer" data-action="product overview">产品概览</a></li><li><a href="../../pricing.html" data-gta="event" data-category="out-footer" data-action="prices">价格</a></li><li><a href="../../apps.html" data-gta="event" data-category="out-footer" data-action="apps">下载</a></li><li><a href="https://bbs.teambition.com" data-gta="event" data-category="out-footer" data-action="community">社区</a></li><li><a href="https://blog.teambition.com/zh/updates" target="_blank" data-gta="event" data-category="out-footer" data-action="updates">最近更新</a></li><li><a href="../../privacy.html" data-gta="event" data-category="out-footer" data-action="privacy">隐私条款</a></li></ul><ul class="nav-group"><h4>公司</h4><li><a href="https://blog.teambition.com/zh/activities" target="_blank" data-gta="event" data-category="out-footer" data-action="news and events">新闻与活动</a></li><li><a href="../../info/team.html" data-gta="event" data-category="out-footer" data-action="team members">团队成员</a></li><li><a href="../../careers.html" target="_blank" data-gta="event" data-category="out-footer" data-action="join us">加入我们</a></li><li><a href="../../info/press.html" data-gta="event" data-category="out-footer" data-action="press release">媒体报道</a></li><li><a href="../../info/partners.html" data-gta="event" data-category="out-footer" data-action="partners">合作伙伴</a></li><li><a href="../../csr.html" data-gta="event" data-category="out-footer" data-action="CSR">公益计划</a></li></ul><ul class="nav-group"><h4>案例</h4><li><a href="../../research/cases.html" data-gta="event" data-category="out-footer" data-action="industry cases">行业案例</a></li><li><a href="../../research/cases/index.html#practices" data-gta="event" data-category="out-footer" data-action="best practice">专题用例</a></li></ul><ul class="nav-group"><h4>开发者</h4><li><a href="../open-source.html" data-gta="event" data-category="out-footer" data-action="open source">开源项目</a></li><li><a href="../open-platform.html" data-gta="event" data-category="out-footer" data-action="developer open-platform">开放平台</a></li><li><a href="../blog.html" data-gta="event" data-category="out-footer" data-action="developer blog">创作随笔</a></li><li><a href="https://help.teambition.com/" data-gta="event" data-category="out-footer" data-action="developer self-test">自助检测</a></li><li><a href="http://status.teambition.net/" data-gta="event" data-category="out-footer" data-action="developer system-status">系统状态</a></li></ul><ul class="nav-group"><h4>联系方式</h4><li><a href="tel:00864000605576">+86 400-060-5576</a><span class="small">周一至周日 8:00 ~ 20:00</span></li><li><a href="mailto:support@teambition.com" data-gta="event" data-category="out-footer" data-action="contact send support email">support@teambition.com</a></li><li><a href="../../info/contactus.html" data-gta="event" data-category="out-footer" data-action="contact us">联系我们</a></li></ul></div></div></div><div class="copyright"><div class="container max1010"><div class="copyandlang text">Copyright © 2013-2016 Teambition<span class="small"><a href="http://www.miitbeian.gov.cn/">沪ICP备11014111号-2</a></span></div><div class="sns-info"><a class="icon icon-wechat"><div class="pop"><label>微信客服</label><p>请扫描二维码</p><div class="qr-wrapper"></div></div></a><a class="icon icon-weibo" href="http://weibo.com/teambition" target="_blank"></a><a class="icon icon-qq"><div class="pop"><label>官方 QQ 群</label><p>群5：475953451</p><p>群6：143032683 (浙江)</p></div></a><a class="icon icon-rss" href="../../../rss.rss" target="_blank"></a><a class="icon icon-dribbble" href="https://dribbble.com/teambition" target="_blank"></a></div></div></div></footer><script id="gta-main" data-google="UA-41231871-1"data-baidu="ec912ecc405ccd050e4cdf452ef4e85a"data-growingio="1b90a59aaa8e4330afbfd547567aa588"></script><script id="global-config" data-env="release"></script><script src="https://dn-st.teambition.net/site/v2.0.0/js/lib.4ec1082b.js"></script><script src="https://dn-st.teambition.net/site/v2.0.0/js/app.00683573.js"></script></body></html>